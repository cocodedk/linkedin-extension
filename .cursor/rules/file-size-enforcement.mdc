---
alwaysApply: true
description: Strict enforcement of 100-line file size limit
---

# File Size Limit: 100 Lines Maximum

## Hard Rule
**NO FILE MAY EXCEED 100 LINES** (except auto-generated files)

## Immediate Actions

### When Creating New Files
1. Plan structure BEFORE writing code
2. If approaching 80 lines, create subfolder structure
3. Split into logical modules at 100 line mark

### When Editing Existing Files >100 Lines
1. **DO NOT add more lines** to the file
2. **IMMEDIATELY refactor** into smaller modules
3. Create a subfolder: `filename/` 
4. Extract logical components into separate files
5. Main file becomes orchestrator (imports only)

## Refactoring Strategy

### Step 1: Identify Responsibilities
Look for distinct concerns in the file:
- UI rendering
- Event handling  
- Data processing
- API calls
- Utilities
- Constants

### Step 2: Create Module Structure
```
original-file.js (150 lines) â†’ REFACTOR TO:

original-file.js (40 lines - main orchestrator)
original-file/
  â”œâ”€â”€ module-a.js (70 lines)
  â”œâ”€â”€ module-b.js (60 lines)
  â””â”€â”€ module-c.js (80 lines)
```

### Step 3: Use Imports/Exports
```javascript
// original-file.js - thin orchestrator
import { funcA } from './original-file/module-a.js';
import { funcB } from './original-file/module-b.js';

// Wire together modules
export function main() {
  funcA();
  funcB();
}
```

## Line Counting Rules

### What Counts as a Line
- Code lines: YES
- Comment lines: YES
- Blank lines: YES
- Import statements: YES
- Everything counts toward the 100 limit

### What Doesn't Count
- Auto-generated file warnings (e.g., "// Generated by...")
- File-level JSDoc at top (if â‰¤5 lines)

## File Type Guidelines

### JavaScript/TypeScript: Max 100 lines
Split into:
- Main file (orchestration)
- UI components
- Business logic
- Utils/helpers
- Constants

### CSS: Max 100 lines
Split into:
- Variables
- Base styles
- Components
- Utilities
- Responsive

### Markdown: Max 100 lines
Split into:
- Overview/README
- Detailed docs in subdirectory
- One topic per file

### HTML: Max 100 lines
Split into:
- Main template
- Partials/includes
- Component templates

## Red Flags (Refactor Immediately)

ðŸš¨ File is 90+ lines â†’ Plan refactoring now
ðŸš¨ File is 100+ lines â†’ STOP, refactor before continuing
ðŸš¨ Adding "just one more function" â†’ NO, refactor first
ðŸš¨ File does multiple things â†’ Split by responsibility
ðŸš¨ Scrolling to navigate file â†’ Too large, refactor

## Good Examples

### âœ… GOOD: Modular Structure
```
popup.js (45 lines)
popup/
  â”œâ”€â”€ ui.js (85 lines)
  â”œâ”€â”€ handlers.js (95 lines)
  â””â”€â”€ utils.js (70 lines)
```

### âŒ BAD: Monolithic File
```
popup.js (350 lines) â† UNACCEPTABLE
```

## Enforcement Process

### During Development
1. Check line count frequently: `wc -l filename`
2. At 80 lines: Prepare to split
3. At 100 lines: MANDATORY split

### During Code Review
1. Reject ANY file >100 lines
2. Request refactoring before merge
3. Check for proper module boundaries

### Automated Check (add to CI)
```bash
# Find files >100 lines (excluding node_modules, etc.)
find . -type f \( -name "*.js" -o -name "*.css" -o -name "*.md" \) \
  ! -path "*/node_modules/*" \
  ! -path "*/.git/*" \
  ! -name "*lock.json" \
  -exec awk 'END {if (NR > 100) print FILENAME, NR}' {} \;
```

## Remember
- Small files = Easy to understand
- Small files = Easy to test
- Small files = Easy to maintain
- Small files = Better architecture

**When in doubt: SPLIT IT OUT**
