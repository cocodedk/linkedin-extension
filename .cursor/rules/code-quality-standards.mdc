---
alwaysApply: true
description: Enforce MVP, KISS, YAGNI, DRY, SOLID principles and file size limits
---

# Code Quality & Architecture Standards

## Core Principles

**MVP:** Build only what's needed now. No speculative features.
**KISS:** Simple solutions > clever ones. Refactor if you can't explain it simply.
**YAGNI:** Don't add functionality until required. Remove unused code.
**DRY:** Extract repeated logic into reusable functions/modules.
**SOLID:** Single responsibility, Open/Closed, Liskov substitution, Interface segregation, Dependency inversion.

## File Size Limits (STRICTLY ENFORCED)

**Max 100 lines** for all files (.js, .ts, .css, .md, .mdc)
**Exception:** Auto-generated files only

### When You Hit 100 Lines
1. STOP immediately
2. Refactor into modules
3. Create subfolder
4. Use imports

### Refactoring Examples

**JavaScript:**
```
popup.js (300 lines) → BAD
popup.js (40 lines) + popup/{ui.js, handlers.js, utils.js} → GOOD
```

**CSS:**
```
styles.css (400 lines) → BAD
styles.css (10 lines imports) + styles/{variables, base, buttons, cards}.css → GOOD
```

**Markdown:**
```
README.md (500 lines) → BAD
README.md (80 lines) + docs/{installation, usage, api}.md → GOOD
```

## Actionable Rules

### Before Writing Code
1. Can this be simpler? (KISS)
2. Do we need this now? (YAGNI)
3. Does this solve ONE problem? (SRP)
4. Will this exceed 100 lines? (Refactor first)

### During Code Review
1. Enforce 100 line limit
2. Check for repeated code (DRY)
3. Verify single responsibility (SRP)
4. Remove unnecessary features (YAGNI)

### When Refactoring
1. Split by responsibility, not just size
2. Create logical module boundaries
3. Use clear, descriptive names
4. Keep main files as thin orchestrators

## Common Patterns

**Module Structure:**
```
feature/
  ├── index.js (10-20 lines - main export)
  ├── component.js (60-80 lines - core logic)
  ├── helpers.js (40-60 lines - utilities)
  └── constants.js (20-30 lines - config)
```

**Import Organization:**
```javascript
// External dependencies
import { lib } from 'external-lib';
// Internal modules
import { helper } from './helpers.js';
```

## Enforcement Checklist

Before committing:
- [ ] File ≤100 lines
- [ ] Single responsibility
- [ ] No repeated code
- [ ] No unused code
- [ ] Simple, not clever
- [ ] Actually needed now

**If ANY unchecked: REFACTOR before commit**
