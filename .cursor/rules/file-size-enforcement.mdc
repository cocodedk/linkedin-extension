---
alwaysApply: true
description: Strict enforcement of 100-line file size limit
---

# File Size Limit: 100 Lines Maximum

## Hard Rule
**NO FILE >100 LINES** (except auto-generated)

## Immediate Actions

**Creating new files:**
1. Plan structure first
2. At 80 lines → prepare subfolder structure
3. At 100 lines → split into modules

**Editing files >100 lines:**
1. DO NOT add more lines
2. IMMEDIATELY refactor
3. Create subfolder: `filename/`
4. Extract components to separate files
5. Main file becomes orchestrator

## Refactoring Strategy

**Step 1: Identify responsibilities** (UI, handlers, logic, API, utils, constants)

**Step 2: Create modules**
```
file.js (150 lines) →
  file.js (40 lines - orchestrator)
  file/{module-a.js, module-b.js, module-c.js}
```

**Step 3: Use imports/exports**
```javascript
import { funcA } from './file/module-a.js';
export function main() { funcA(); }
```

## Line Counting

**Counts:** Code, comments, blank lines, imports (everything)
**Doesn't count:** Auto-generated warnings, file-level JSDoc (≤5 lines)

## File Type Guidelines

**JavaScript/TypeScript:** Split into main/UI/logic/utils/constants
**CSS:** Split into variables/base/components/utilities/responsive
**Markdown:** Split into overview + docs subdirectory (one topic per file)
**HTML:** Split into main template + partials/includes

## Red Flags

- 90+ lines → Plan refactoring now
- 100+ lines → STOP, refactor before continuing
- "Just one more function" → NO, refactor first
- Multiple responsibilities → Split by concern
- Scrolling to navigate → Too large

## Examples

**✅ GOOD:** `popup.js (45)` + `popup/{ui.js, handlers.js, utils.js}`
**❌ BAD:** `popup.js (350)` ← UNACCEPTABLE

## Enforcement

**During development:** Check line count frequently (`wc -l file`)
**At 80 lines:** Prepare to split
**At 100 lines:** MANDATORY split

**Automated check:**
```bash
find . -type f \( -name "*.js" -o -name "*.css" -o -name "*.md" \) \
  ! -path "*/node_modules/*" ! -name "*lock.json" \
  -exec awk 'END {if (NR > 100) print FILENAME, NR}' {} \;
```

**Small files = Easy to understand, test, maintain**
**When in doubt: SPLIT IT OUT**
